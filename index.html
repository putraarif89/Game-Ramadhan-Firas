<!doctype html>
<html lang="ms" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pusat Permainan Pintar</title>
    <script src="https://cdn.tailwindcss.com/3.4.17"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Nunito', sans-serif; }
        .game-card { transition: all 0.3s ease; cursor: pointer; }
        .game-card:hover { transform: translateY(-5px); }
        @keyframes bounce-sm { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        .animate-star { animation: bounce-sm 0.5s ease-in-out infinite; }
    </style>
</head>
<body class="h-full bg-[#0f172a] text-white">
    <div id="app" class="min-h-full p-4">
        
        <div class="max-w-4xl mx-auto flex justify-between items-center mb-8">
            <h1 class="text-3xl font-black text-amber-400">üéÆ Game Pintar</h1>
            <div class="bg-white/10 px-4 py-2 rounded-full text-cyan-300">
                Total ‚≠ê: <span id="total-stars" class="font-bold">0</span>
            </div>
        </div>

        <div id="menu-screen" class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-4">
            </div>

        <div id="game-screen" class="hidden max-w-lg mx-auto">
            <div class="flex justify-between mb-4 items-center">
                <button onclick="goHome()" class="text-sm bg-white/10 px-3 py-1 rounded">Kembali</button>
                <div id="timer-bar" class="flex-1 mx-4 h-3 bg-white/20 rounded-full overflow-hidden">
                    <div id="timer-fill" class="h-full bg-green-500 w-full transition-all duration-100"></div>
                </div>
                <div id="live-stars" class="text-amber-400 font-bold">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
            </div>

            <div class="bg-white/10 backdrop-blur-xl rounded-3xl p-6 border border-white/20 shadow-2xl">
                <div id="q-emoji" class="text-6xl text-center mb-4"></div>
                <h2 id="q-text" class="text-2xl text-center font-bold mb-8 leading-tight"></h2>
                <div id="options-container" class="grid grid-cols-1 gap-3"></div>
            </div>
        </div>

        <div id="result-screen" class="hidden max-w-lg mx-auto text-center py-10">
            <div id="res-emoji" class="text-9xl mb-4">üéâ</div>
            <h2 class="text-4xl font-black text-amber-400 mb-2">Hebat!</h2>
            <div id="res-stars" class="text-4xl mb-4 text-amber-400"></div>
            <p id="res-msg" class="text-xl mb-8"></p>
            <button onclick="goHome()" class="w-full bg-amber-500 text-white font-bold py-4 rounded-2xl text-xl shadow-lg">Main Game Lain üöÄ</button>
        </div>

    </div>

    <script>
        // DATA SEMUA GAME
        const games = [
            { id: 'ramadhan', title: 'Petualangan Ramadhan', emoji: 'üåô', color: 'from-emerald-500 to-teal-700', 
              data: [
                { q: "Bulan ke berapa Ramadhan?", o: ["7", "8", "9", "10"], c: 2, e: "üåô" },
                { q: "Makan sebelum Subuh?", o: ["Sahur", "Iftar", "Makan Tengahari"], c: 0, e: "üçΩÔ∏è" }
              ]},
            { id: 'math', title: 'Bijak Matematik', emoji: '‚ûï', color: 'from-blue-500 to-indigo-700',
              data: [
                { q: "2 + 3 = ?", o: ["4", "5", "6"], c: 1, e: "üî¢" },
                { q: "10 - 4 = ?", o: ["5", "6", "7"], c: 1, e: "üßÆ" }
              ]},
            { id: 'haiwan', title: 'Kenali Haiwan', emoji: 'ü¶Å', color: 'from-orange-500 to-red-700',
              data: [
                { q: "Haiwan yang ada belalai?", o: ["Kucing", "Gajah", "Zirafah"], c: 1, e: "üêò" },
                { q: "Siapa Raja Rimba?", o: ["Singa", "Harimau", "Monyet"], c: 0, e: "ü¶Å" }
              ]},
            { id: 'warna', title: 'Dunia Warna', emoji: 'üé®', color: 'from-pink-500 to-purple-700',
              data: [
                { q: "Warna Pisang?", o: ["Merah", "Kuning", "Biru"], c: 1, e: "üçå" },
                { q: "Campuran Biru + Kuning?", o: ["Hijau", "Oren", "Ungu"], c: 0, e: "üé®" }
              ]},
            { id: 'sains', title: 'Sains Cilik', emoji: 'üöÄ', color: 'from-cyan-500 to-blue-700',
              data: [
                { q: "Planet tempat kita tinggal?", o: ["Marikh", "Bumi", "Musytari"], c: 1, e: "üåç" },
                { q: "Benda yang ditarik magnet?", o: ["Plastik", "Besi", "Kayu"], c: 1, e: "üß≤" }
              ]},
            { id: 'buah', title: 'Kebun Buah', emoji: 'üçé', color: 'from-red-500 to-rose-700',
              data: [
                { q: "Raja Buah?", o: ["Durian", "Manggis", "Rambutan"], c: 0, e: "üëë" },
                { q: "Buah yang ada banyak air?", o: ["Epal", "Tembikai", "Pisang"], c: 1, e: "üçâ" }
              ]},
            { id: 'kenderaan', title: 'Lalu Lintas', emoji: 'üèéÔ∏è', color: 'from-yellow-500 to-amber-700',
              data: [
                { q: "Kenderaan di udara?", o: ["Kereta", "Kapal Terbang", "Bas"], c: 1, e: "‚úàÔ∏è" },
                { q: "Kenderaan yang ada siren?", o: ["Ambulans", "Lori", "Basikal"], c: 0, e: "üöë" }
              ]},
            { id: 'inggeris', title: 'English Fun', emoji: 'üá¨üáß', color: 'from-slate-500 to-slate-800',
              data: [
                { q: "What is 'Kucing' in English?", o: ["Dog", "Cat", "Bird"], c: 1, e: "üê±" },
                { q: "Color of the Sky?", o: ["Blue", "Red", "Green"], c: 0, e: "‚òÅÔ∏è" }
              ]}
        ];

        let activeGame = null;
        let currentQIdx = 0;
        let totalStarsCollected = 0;
        let gameStars = 0;
        let timer;
        let startTime;

        // INIT MENU
        function renderMenu() {
            const container = document.getElementById('menu-screen');
            container.innerHTML = '';
            let globalStars = 0;

            games.forEach(game => {
                const savedStars = parseInt(localStorage.getItem(`stars_${game.id}`)) || 0;
                globalStars += savedStars;
                
                const card = document.createElement('div');
                card.className = `game-card bg-gradient-to-br ${game.color} p-6 rounded-3xl shadow-xl`;
                card.onclick = () => startThisGame(game.id);
                card.innerHTML = `
                    <div class="text-4xl mb-2">${game.emoji}</div>
                    <h3 class="text-xl font-bold">${game.title}</h3>
                    <div class="text-amber-300 mt-2">‚≠ê Rekod: ${savedStars}</div>
                `;
                container.appendChild(card);
            });
            document.getElementById('total-stars').textContent = globalStars;
        }

        function startThisGame(id) {
            activeGame = games.find(g => g.id === id);
            currentQIdx = 0;
            gameStars = 0;
            document.getElementById('menu-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            document.getElementById('result-screen').classList.add('hidden');
            showQuestion();
        }

        function showQuestion() {
            const q = activeGame.data[currentQIdx];
            document.getElementById('q-emoji').textContent = q.e;
            document.getElementById('q-text').textContent = q.q;
            
            const optCont = document.getElementById('options-container');
            optCont.innerHTML = '';
            q.o.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = "bg-white/10 hover:bg-white/20 p-4 rounded-2xl text-left border border-white/10 transition-all font-bold";
                btn.textContent = opt;
                btn.onclick = () => submitAnswer(i);
                optCont.appendChild(btn);
            });

            startTimer();
        }

        function startTimer() {
            startTime = Date.now();
            let timeLeft = 15000; // 15 saat
            const bar = document.getElementById('timer-fill');
            const starText = document.getElementById('live-stars');

            clearInterval(timer);
            timer = setInterval(() => {
                const elapsed = Date.now() - startTime;
                const remain = 15000 - elapsed;
                const percent = (remain / 15000) * 100;
                
                bar.style.width = percent + '%';
                
                // Live Star Calculation
                let stars = 1;
                if (elapsed < 3000) stars = 5;
                else if (elapsed < 6000) stars = 4;
                else if (elapsed < 10000) stars = 3;
                else if (elapsed < 13000) stars = 2;
                
                starText.textContent = '‚≠ê'.repeat(stars);

                if (remain <= 0) {
                    clearInterval(timer);
                    submitAnswer(-1);
                }
            }, 100);
        }

        function submitAnswer(idx) {
            clearInterval(timer);
            const elapsed = Date.now() - startTime;
            const q = activeGame.data[currentQIdx];

            if (idx === q.c) {
                let stars = 1;
                if (elapsed < 3000) stars = 5;
                else if (elapsed < 6000) stars = 4;
                else if (elapsed < 10000) stars = 3;
                else if (elapsed < 13000) stars = 2;
                gameStars += stars;
                
                // Feedback visual ringkas
                document.body.style.backgroundColor = '#064e3b';
                setTimeout(() => document.body.style.backgroundColor = '#0f172a', 300);
            }

            currentQIdx++;
            if (currentQIdx < activeGame.data.length) {
                showQuestion();
            } else {
                finishGame();
            }
        }

        function finishGame() {
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            
            const totalPossible = activeGame.data.length * 5;
            const finalRating = Math.ceil((gameStars / totalPossible) * 5);
            
            document.getElementById('res-stars').textContent = '‚≠ê'.repeat(finalRating);
            document.getElementById('res-msg').textContent = `Anda dapat ${gameStars} mata bintang!`;

            // Simpan skor tertinggi ke LocalStorage
            const prevBest = parseInt(localStorage.getItem(`stars_${activeGame.id}`)) || 0;
            if (gameStars > prevBest) {
                localStorage.setItem(`stars_${activeGame.id}`, gameStars);
            }
        }

        function goHome() {
            clearInterval(timer);
            document.getElementById('menu-screen').classList.remove('hidden');
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.add('hidden');
            renderMenu();
        }

        renderMenu();
    </script>
</body>
</html>
